<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>Sample Report Selection Page</title>
    </head>
    <body onload="init()">
        <div id="explorer">
            <script type="text/javascript" src="http://127.0.0.1:8700/iportal/jsapi"></script>
            <script type="text/javascript">
                function init( ) {
                    actuate.load("reportexplorer");
                    requestOpts = new actuate.RequestOptions();
                    actuate.initialize("http://127.0.0.1:8700/iportal/", requestOpts, "administrator", "", runReportExplorer);
                }
                
                function runReportExplorer( ) {
                    var explorer = new actuate.ReportExplorer("explorer");
                    explorer.registerEventHandler(actuate.reportexplorer.EventConstants.ON_SELECTION_CHANGED, selectionChanged);
                    explorer.setFolderName("/Applications");
                    var resultDef = "Name|FileType|Version|VersionName|Description";
                    explorer.setResultDef(resultDef.split("|"));
                    explorer.submit( );
                }
                
                function selectionChanged(selectedItem, pathName ){
                    file = pathName;
                    alert ("File selected: " + file);
                }

            </script>
        </div>
    </body>
</html>